<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CC Widgets as web-component</title>
    <style>
      .disabled {
        display: none;
      }
    </style>
  </head>
  <body>
    <h1>Contact Center widgets as web-component</h1>
    <input
      type="text"
      placeholder="Enter your access token"
      id="access_token_elem"
      onkeyup="switchButtonState()"
      autocomplete="off"
      spellcheck="false"
      autocapitalize="off"
    />
    <button onclick="initWidgets()" disabled>Init Widgets</button>
    <script src="dist/bundle.js"></script>
    <div id="widgets-container" class="disabled">
      <widget-cc-station-login id="cc-station-login"></widget-cc-station-login>
      <widget-cc-user-state></widget-cc-user-state>
    </div>
  </body>
  <script>
    const widgetsContainer = document.getElementById('widgets-container');
    const accessTokenElem = document.getElementById('access_token_elem');
    const ccStationLogin = document.getElementById('cc-station-login');

    function switchButtonState(){
      const buttonElem = document.querySelector('button');
      buttonElem.disabled = accessTokenElem.value.trim() === '';
    }

    function initWidgets(){
      const webexConfig = {
          fedramp: false,
          logger: {
            level: 'log'
          },
      }
      store.init({
        webexConfig,
        access_token: accessTokenElem.value.trim()
      }).then(() => {
        ccStationLogin.onLogin = loginSuccess;
        ccStationLogin.onLogout = logoutSuccess;
        widgetsContainer.classList.remove('disabled');
      }).catch((error) => {
        console.error('Failed to initialize widgets:', error);
      });
    }

    function loginSuccess(){
      console.log('Agent login has been succesful');
    }

    function logoutSuccess(){
      console.log('Agent logout has been succesful');
    }
  </script>
</html>
